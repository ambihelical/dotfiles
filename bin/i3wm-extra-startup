#!/bin/bash

# This seems to be needed in order for the keyboard settings to have effect.
sleep 1

# setup displays
${HOME}/bin/i3wm-monitor-setup

# desktop integration
xsettingsd -c ~/.config/xsettingsd &

# setup keyboard, mouse, bluetooth
${HOME}/bin/i3wm-keyboard-setup

# root gets garbled sometimes, so set solid color
xsetroot -solid "#333333"

# try to mount google drive if gdfuse config exists and there's a user space driver
if type google-drive-ocamlfuse > /dev/null 2>&1;  then
    gdrive=~/GDrive
    if [ -e ~/.config/gdfuse/default/config ]; then
        if mountpoint -q $gdrive ; then
            echo "$gdrive already mounted, no action"
        else
            [ -d $gdrive ] || mkdir -p $gdrive
            google-drive-ocamlfuse -xdgbd $gdrive
            echo "Google drive $gdrive ready"
        fi
    else
        echo "gdfuse must be configured for google drive"
    fi
else
    echo "No driver for google drive, no GDrive for you"
fi
